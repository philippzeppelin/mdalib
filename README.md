# Техническое задание (ТЗ) на тестовое задание
---

## Цель проекта

Проверить знания кандидата в области:
- Работы с фреймворком Spring (Spring Boot, Spring Data JPA).
- Hibernate и работы с базой данных.
- Основ программирования REST API.
- Написания автоматизированных тестов.
- Опционально: Docker, Git, JWT авторизация.

---

## Описание задачи

Необходимо разработать сервис управления данными библиотеки. Сервис должен предоставлять возможности создания, обновления, удаления и получения информации о книгах, авторах и дополнительных сущностях, связанных с библиотечной системой.

---

## Основные требования

### 1. Модели данных

Реализовать следующие классы данных:

- **Автор (Author):**
    - `id` (уникальный идентификатор)
    - `name` (имя автора)
    - `birthDate` (дата рождения)
    - Связь "один ко многим" с классом `Book`.

- **Книга (Book):**
    - `id` (уникальный идентификатор)
    - `title` (название книги)
    - `publicationYear` (год публикации)
    - `author` (ссылка на автора)
    - `availability` (ссылка на информацию о наличии на складе)
    - Связь "многие ко многим" с классом `Availability`.

- **Наличие на складе (Availability):**
    - `id` (уникальный идентификатор)
    - `location` (местоположение склада)
    - `quantity` (количество экземпляров)
    - Связь "многие ко многим" с классом `Book`.

---

### 2. API-эндпоинты

Реализовать следующие REST API:

#### А. Авторы
- **GET /authors**  
  Получение списка всех авторов с возможностью фильтрации по имени (`name`) и пагинацией (`page`, `size`).

- **POST /authors**  
  Создание нового автора. Требуется передать имя (`name`) и дату рождения (`birthDate`).

#### Б. Книги
- **GET /authors/{authorId}/books**  
  Получение списка книг, написанных конкретным автором.

- **POST /books**  
  Добавление новой книги. Требуется указать название (`title`), год публикации (`publicationYear`), автора (`authorId`) и информацию о наличии (`availabilityId`).

- **DELETE /books/{bookId}**  
  Удаление книги по её идентификатору.

#### В. Наличие на складе
- **GET /availability**  
  Получение списка местоположений складов с количеством доступных книг.

---

### 3. Тестирование

- **Unit-тесты:**
    - Написать unit-тесты для основных методов бизнес-логики.
    - Покрыть как минимум основные сценарии работы с авторами, книгами и наличием на складе.

- **Интеграционные тесты:**
    - Написать интеграционные тесты для проверки работы API.
    - Использовать подходящие инструменты (например, TestRestTemplate или WebTestClient).

---

## Дополнительные (необязательные) требования

1. **Dockerизировать приложение**
    - Обернуть приложение в Docker-контейнер.
    - Предоставить `Dockerfile` и `docker-compose.yml` для запуска приложения вместе с базой данных.

2. **Использование Git**
    - Разместить код в репозитории GitHub или GitLab.
    - Использовать понятную структуру коммитов.

3. **Валидация данных**
    - Добавить проверку входных данных с помощью аннотаций Hibernate Validator (например, `@NotNull`, `@Size`, `@Min`, `@Max`).

4. **Обработка ошибок**
    - Реализовать глобальный обработчик исключений для корректного возврата ошибок клиенту (например, `@ControllerAdvice`).

5. **Логирование**
    - Настроить логирование с использованием SLF4J/Logback.

6. **Оптимизация запросов**
    - Избежать N+1 проблем при работе с базой данных, используя подходящие стратегии загрузки (eager/lazy).

7. **Авторизация через JWT и Spring Security**
    - Реализовать механизм аутентификации и авторизации пользователей с использованием JSON Web Tokens (JWT) и Spring Security.
        - Регистрация пользователя.
        - Аутентификация пользователя.
        - Защита API.
        - Эндпоинты для проверки токена.
        - Обработка истекших токенов.

---

## Технические требования

1. **Фреймворки и технологии:**
    - Spring Boot (версия 2.x или выше).
    - Hibernate + Spring Data JPA.
    - PostgreSQL (или другая реляционная база данных на выбор кандидата).

2. **Стек:**
    - Java 11+.
    - Maven или Gradle для управления зависимостями.

3. **Формат ответов API:**
    - JSON.

4. **Стиль кода:**
    - Чистый и понятный код.
    - Комментарии там, где это необходимо.

---

## Критерии оценки

1. **Функциональность** (40%):
    - Все обязательные требования реализованы.
    - Приложение работает корректно без ошибок.

2. **Качество кода** (20%):
    - Структурированность кода.
    - Использование лучших практик программирования.
    - Отсутствие дублирования кода.

3. **Тестирование** (20%):
    - Unit-тесты покрывают основные методы бизнес-логики.
    - Интеграционные тесты проверяют работу API.

4. **Архитектура** (10%):
    - Корректное использование слоев (controller, service, repository).
    - Хорошее проектирование базы данных.

5. **Дополнительные требования** (10%):
    - Реализация необязательных пунктов.

---

## Время выполнения

По договоренности

---

## Подготовка к сдаче

1. Загрузите готовый проект в репозиторий GitHub/GitLab.
2. Убедитесь, что проект можно легко собрать и запустить.
3. Пришлите ссылку на репозиторий и инструкцию по запуску приложения.

---

Если у вас есть вопросы или необходимы уточнения, обратитесь к менеджеру проекта. Удачи!
